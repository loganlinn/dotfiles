#!/usr/bin/env bash
set -euo pipefail

usage() {
  cat <<EOF
Usage: aws-secretctl <command> [options]

Manage AWS Secrets Manager secrets and SSM Parameter Store parameters.

Commands:
  list      List all secrets/parameters
  select    Select a secret/parameter interactively
  get       Get secret/parameter value
  edit      Edit a secret/parameter with vipe
  delete    Delete a secret/parameter

All commands support both Secrets Manager and SSM Parameter Store.
Use --ssm flag to explicitly target SSM, or let ARN auto-detection handle it.

Run 'aws-secretctl <command> --help' for more information on a command.

Examples:
  aws-secretctl list
  aws-secretctl list --ssm
  aws-secretctl get my-secret
  aws-secretctl get --ssm /prod/db/password
  aws-secretctl edit my-secret
  aws-secretctl edit --ssm /prod/api/key
  aws-secretctl delete my-secret --force
  aws-secretctl delete --ssm my-param
EOF
}

if [[ $# -eq 0 ]]; then
  usage
  exit 1
fi

subcommand="$1"
shift

case "$subcommand" in
-h | --help)
  usage
  exit 0
  ;;
esac

exec "aws-secretctl-$subcommand" "$@"
