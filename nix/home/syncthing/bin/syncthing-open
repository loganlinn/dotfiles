#!/usr/bin/env python3

import json
import subprocess
import sys
import webbrowser


def syncthing_cli_system():
    p = subprocess.run(["syncthing", "cli", "show", "system"], capture_output=True)
    p.check_returncode()
    return json.loads(p.stdout)


def syncthing_gui_url():
    system = syncthing_cli_system()
    return f"http://{system['guiAddressUsed']}"


def main():
    url = syncthing_gui_url()
    print(f"Opening in browser: {url}")
    webbrowser.open(url)
    return 0


if __name__ == "__main__":
    sys.exit(main())
